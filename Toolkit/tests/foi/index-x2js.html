<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <title>Features of interest</title>

    <!-- VENDOR -->
    <link rel="stylesheet" href="vendor/all-in-one/vendor.css"/>
    <script type="text/javascript" src="vendor/all-in-one/vendor.js"></script>

    <script type="text/javascript" src="js/vkbeautify.0.99.00.beta.js"></script>

    <script type="text/javascript" src="../../vendor-local/x2js/xml2json.js"></script>

    <!-- OSH Core -->
    <script type="text/javascript" src="../../src/osh/osh-Template.js"></script>
    <!-- OSH buffer sync lib -->
    <script type="text/javascript" src="../../src/osh/osh-Utils.js"></script>

    <script type="text/javascript" src="../../src/osh/osh-BaseClass.js"></script>

    <script type="text/javascript" src="../../src/osh/osh-Buffer.js"></script>
    <!-- OSH controller lib -->
    <script type="text/javascript" src="../../src/osh/osh-MapEvent.js"></script>
    <script type="text/javascript" src="../../src/osh/osh-EventManager.js"></script>
    <!-- OSH Video component parser -->
    <script type="text/javascript" src="../../src/osh/dataconnector/osh-DataConnector.js"></script>
    <script type="text/javascript" src="../../src/osh/dataconnector/osh-DataConnector-Websocket.js"></script>
    <script type="text/javascript" src="../../src/osh/datareceiver/osh-DataReceiver-DataSource.js"></script>

    <!-- OSH Video component parser -->
    <script type="text/javascript" src="../../src/osh/datareceiver/osh-DataReceiver-DataSource.js"></script>
    <script type="text/javascript" src="../../src/osh/datareceiver/osh-DataReceiverController.js"></script>
    <script type="text/javascript"
    <script type="text/javascript" src="../../src/osh/datareceiver/osh-DataReceiver-DataSourceVideoH264.js"></script>

    <script type="text/javascript" src="../../src/osh/ui/styler/osh-UI-Styler.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/styler/osh-UI-StylerCurve.js"></script>

    <script type="text/javascript" src="../../src/osh/ui/view/osh-UI-View.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/view/map/osh-UI-LeafletView.js"></script>
    <script type="text/javascript" src="../../src/osh/ui/styler/osh-UI-StylerPointMarker.js"></script>

    <script type="text/javascript" src="../../src/osh/discovery/osh-Server.js"></script>
    <script type="text/javascript" src="../../src/osh/discovery/osh-Sensor.js"></script>

</head>
<body id="body">
<h2>Test Get feature of interest</h2>
<textarea id="xmlDetails"></textarea>
<div id="leafletMap" style="height:100%;width:100%"></div>
<style>
    .leaflet-container {
        height: 100%;
    }

    body {
        margin: 0;
        height: calc(100% - 70px);
    }

    html {
        height: 100%;
    }

    #xmlDetails {
        float:left;
        width:50%;
        height:100%
    }
</style>
<script type="text/javascript">
   var xmlInput =   '   <sos:GetResultTemplateResponse xmlns:sos="http://www.opengis.net/sos/2.0" xmlns:swe="http://www.opengis.net/swe/2.0" xmlns:xlink="http://www.w3.org/1999/xlink">  '  +
       '   <sos:resultStructure>  '  +
       '   <swe:DataRecord definition="http://sensorml.com/ont/swe/property/AVLData">  '  +
       '   <swe:field name="time">  '  +
       '   <swe:Time definition="http://www.opengis.net/def/property/OGC/0/SamplingTime" referenceFrame="http://www.opengis.net/def/trs/BIPM/0/UTC">  '  +
       '   <swe:label>Sampling Time</swe:label>  '  +
       '   <swe:uom xlink:href="http://www.opengis.net/def/uom/ISO-8601/0/Gregorian"/>  '  +
       '   </swe:Time>  '  +
       '   </swe:field>  '  +
       '   <swe:field name="veh-id" xlink:role="urn:osh:entityID">  '  +
       '   <swe:Category definition="http://sensorml.com/ont/swe/property/Vehicle-ID">  '  +
       '   <swe:label>Vehicle ID</swe:label>  '  +
       '   <swe:description>Mobile Vehicle Identification</swe:description>  '  +
       '   </swe:Category>  '  +
       '   </swe:field>  '  +
       '   <swe:field name="location">  '  +
       '   <swe:Vector definition="http://www.opengis.net/def/property/OGC/0/SensorLocation" referenceFrame="http://www.opengis.net/def/crs/EPSG/0/4326">  '  +
       '   <swe:label>Vehicle Location</swe:label>  '  +
       '   <swe:coordinate name="lat">  '  +
       '   <swe:Quantity axisID="Lat">  '  +
       '   <swe:label>Geodetic Latitude</swe:label>  '  +
       '   <swe:uom code="deg"/>  '  +
       '   </swe:Quantity>  '  +
       '   </swe:coordinate>  '  +
       '   <swe:coordinate name="lon">  '  +
       '   <swe:Quantity axisID="Long">  '  +
       '   <swe:label>Longitude</swe:label>  '  +
       '   <swe:uom code="deg"/>  '  +
       '   </swe:Quantity>  '  +
       '   </swe:coordinate>  '  +
       '   </swe:Vector>  '  +
       '   </swe:field>  '  +
       '   </swe:DataRecord>  '  +
       '   </sos:resultStructure>  '  +
       '   <sos:resultEncoding>  '  +
       '   <swe:TextEncoding blockSeparator=" " collapseWhiteSpaces="true" decimalSeparator="." tokenSeparator=","/>  '  +
       '   </sos:resultEncoding>  '  +
       '  </sos:GetResultTemplateResponse>  ' ;

   var options = {
       xmlns: false, // does not keep xmlns
       attributePrefix:"",
       prefix: false,
       removeAttrPrefix:true
   };

   var x2js = new X2JS(options);

   var jsonObj = x2js.xml_str2json( xmlInput);
   console.log(vkbeautify.json(JSON.stringify(jsonObj.GetResultTemplateResponse.resultStructure)));
</script>

</body>
</html>
